# Java 反射 — 例子

简短演示如何使用 Java 反射：
- 获取 Class 对象（.class、forName、对象.getClass）。
- 动态创建实例（无参构造和带参构造）。
- 访问并修改私有字段。
- 调用公有/私有方法。
- 读取注解和枚举成员/方法列表。

示例代码（放在同一包下，或按注释修改包名）：
```java
package docs.java.反射;
import java.lang.annotation.Retention;
import java.lang.annotation.RetentionPolicy;

@Retention(RetentionPolicy.RUNTIME)
@interface MyAnnotation {
    String value();
}

class MyClass {
    @MyAnnotation("Hello")
    public void myMethod() {
        System.out.println("MyClass.myMethod()");
    }
}
class PrivateClass {
    private String name;

    public PrivateClass(String name) {
        this.name = name;
    }

    private String getName() {
        return name;
    }
}
public class ReflectionExample {
    public static void main(String[] args) throws Exception {
        // 获取 Class 对象
        Class<?> cls1 = MyClass.class;
        Class<?> cls2 = Class.forName("docs.java.反射.MyClass");
        MyClass myObj = new MyClass();
        Class<?> cls3 = myObj.getClass();

        // 动态创建实例
        MyClass instance1 = (MyClass) cls1.getDeclaredConstructor().newInstance();
        PrivateClass instance2 = (PrivateClass) Class.forName("docs.java.反射.PrivateClass")
                .getDeclaredConstructor(String.class).newInstance("PrivateName");

        // 访问并修改私有字段
        java.lang.reflect.Field nameField = PrivateClass.class.getDeclaredField("name");
        nameField.setAccessible(true);
        nameField.set(instance2, "NewName");
        System.out.println("Updated name: " + nameField.get(instance2));
        // 调用公有/私有方法
        java.lang.reflect.Method privateMethod = PrivateClass.class.getDeclaredMethod("getName");
        privateMethod.setAccessible(true);
        String name = (String) privateMethod.invoke(instance2);
        System.out.println("Private method getName(): " + name);
        // 读取注解
        java.lang.reflect.Method myMethod = MyClass.class.getMethod("myMethod");
        MyAnnotation annotation = myMethod.getAnnotation(MyAnnotation.class);
        if (annotation != null) {
            System.out.println("Annotation value: " + annotation.value());
        }
        // 列出类的方法
        System.out.println("Methods in MyClass:");
        for (java.lang.reflect.Method method : MyClass.class.getDeclaredMethods()) {
            System.out.println(" - " + method.getName());
        }
        // 列出类的枚举成员
        System.out.println("Enum constants in Thread.State:");
        for (Thread.State state : Thread.State.values()) {
            System.out.println(" - " + state);
        }
    }
}
``` 