# âš ï¸ å¼‚å¸¸å¤„ç†

## å¼‚å¸¸æ¦‚è¿°

å¼‚å¸¸ï¼ˆExceptionï¼‰æ˜¯ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿçš„é”™è¯¯æˆ–å¼‚å¸¸æƒ…å†µã€‚Java æä¾›äº†å®Œå–„çš„å¼‚å¸¸å¤„ç†æœºåˆ¶ã€‚

### å¼‚å¸¸ç±»å‹

- **Error**ï¼šç³»ç»Ÿé”™è¯¯ï¼Œç¨‹åºæ— æ³•å¤„ç†
- **Exception**ï¼šç¨‹åºå¼‚å¸¸ï¼Œå¯ä»¥å¤„ç†
  - **RuntimeException**ï¼šè¿è¡Œæ—¶å¼‚å¸¸ï¼ˆéæ£€æŸ¥å¼‚å¸¸ï¼‰
  - **å…¶ä»– Exception**ï¼šæ£€æŸ¥å¼‚å¸¸

## å¼‚å¸¸ç±»å±‚æ¬¡ç»“æ„

```
Throwable
â”œâ”€â”€ Error
â”‚   â”œâ”€â”€ OutOfMemoryError
â”‚   â”œâ”€â”€ StackOverflowError
â”‚   â””â”€â”€ ...
â””â”€â”€ Exception
    â”œâ”€â”€ RuntimeException
    â”‚   â”œâ”€â”€ NullPointerException
    â”‚   â”œâ”€â”€ ArrayIndexOutOfBoundsException
    â”‚   â”œâ”€â”€ IllegalArgumentException
    â”‚   â””â”€â”€ ...
    â””â”€â”€ å…¶ä»– Exception
        â”œâ”€â”€ IOException
        â”œâ”€â”€ SQLException
        â””â”€â”€ ...
```

## try-catch-finally

### åŸºæœ¬è¯­æ³•

```java
try {
    // å¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„ä»£ç 
} catch (ExceptionType e) {
    // å¤„ç†å¼‚å¸¸
} finally {
    // æ— è®ºæ˜¯å¦å‘ç”Ÿå¼‚å¸¸éƒ½ä¼šæ‰§è¡Œçš„ä»£ç 
}
```

### ç¤ºä¾‹

```java
try {
    int result = 10 / 0;  // æŠ›å‡º ArithmeticException
} catch (ArithmeticException e) {
    System.out.println("é™¤æ•°ä¸èƒ½ä¸º0: " + e.getMessage());
} finally {
    System.out.println("finally å—æ‰§è¡Œ");
}
```

### å¤šä¸ª catch

```java
try {
    int[] arr = new int[5];
    arr[10] = 5;  // å¯èƒ½æŠ›å‡º ArrayIndexOutOfBoundsException
    int result = 10 / 0;  // å¯èƒ½æŠ›å‡º ArithmeticException
} catch (ArrayIndexOutOfBoundsException e) {
    System.out.println("æ•°ç»„ç´¢å¼•è¶Šç•Œ: " + e.getMessage());
} catch (ArithmeticException e) {
    System.out.println("ç®—æœ¯å¼‚å¸¸: " + e.getMessage());
} catch (Exception e) {
    System.out.println("å…¶ä»–å¼‚å¸¸: " + e.getMessage());
}
```

### try-with-resourcesï¼ˆJava 7+ï¼‰

```java
try (FileInputStream fis = new FileInputStream("file.txt")) {
    // ä½¿ç”¨èµ„æº
    int data = fis.read();
} catch (IOException e) {
    System.out.println("IO å¼‚å¸¸: " + e.getMessage());
}
// èµ„æºè‡ªåŠ¨å…³é—­
```

## throws å…³é”®å­—

### æŠ›å‡ºå¼‚å¸¸

```java
public void method() throws IOException {
    throw new IOException("IO é”™è¯¯");
}

// è°ƒç”¨æ–¹æ³•éœ€è¦å¤„ç†å¼‚å¸¸
try {
    method();
} catch (IOException e) {
    System.out.println("æ•è·å¼‚å¸¸: " + e.getMessage());
}
```

### æ–¹æ³•å£°æ˜

```java
public void readFile(String filename) throws IOException {
    FileInputStream fis = new FileInputStream(filename);
    // è¯»å–æ–‡ä»¶
}

// è°ƒç”¨è€…å¿…é¡»å¤„ç†å¼‚å¸¸
public void processFile() {
    try {
        readFile("file.txt");
    } catch (IOException e) {
        System.out.println("æ–‡ä»¶è¯»å–å¤±è´¥: " + e.getMessage());
    }
}
```

## throw å…³é”®å­—

### æŠ›å‡ºå¼‚å¸¸

```java
public void validateAge(int age) {
    if (age < 0 || age > 150) {
        throw new IllegalArgumentException("å¹´é¾„å¿…é¡»åœ¨ 0-150 ä¹‹é—´");
    }
}

// ä½¿ç”¨
try {
    validateAge(-1);
} catch (IllegalArgumentException e) {
    System.out.println("éªŒè¯å¤±è´¥: " + e.getMessage());
}
```

### è‡ªå®šä¹‰å¼‚å¸¸

```java
// è‡ªå®šä¹‰å¼‚å¸¸ç±»
public class CustomException extends Exception {
    public CustomException(String message) {
        super(message);
    }
}

// ä½¿ç”¨
public void method() throws CustomException {
    throw new CustomException("è‡ªå®šä¹‰å¼‚å¸¸");
}
```

## å¸¸è§å¼‚å¸¸ç±»å‹

### RuntimeExceptionï¼ˆè¿è¡Œæ—¶å¼‚å¸¸ï¼‰

```java
// NullPointerException
String str = null;
int length = str.length();  // æŠ›å‡º NullPointerException

// ArrayIndexOutOfBoundsException
int[] arr = new int[5];
int value = arr[10];  // æŠ›å‡º ArrayIndexOutOfBoundsException

// IllegalArgumentException
public void setAge(int age) {
    if (age < 0) {
        throw new IllegalArgumentException("å¹´é¾„ä¸èƒ½ä¸ºè´Ÿæ•°");
    }
}

// NumberFormatException
int num = Integer.parseInt("abc");  // æŠ›å‡º NumberFormatException

// ClassCastException
Object obj = "Hello";
Integer num = (Integer) obj;  // æŠ›å‡º ClassCastException
```

### æ£€æŸ¥å¼‚å¸¸ï¼ˆChecked Exceptionï¼‰

```java
// IOException
try {
    FileInputStream fis = new FileInputStream("file.txt");
} catch (IOException e) {
    System.out.println("IO å¼‚å¸¸: " + e.getMessage());
}

// SQLException
try {
    Connection conn = DriverManager.getConnection(url);
} catch (SQLException e) {
    System.out.println("æ•°æ®åº“å¼‚å¸¸: " + e.getMessage());
}
```

## å¼‚å¸¸å¤„ç†æœ€ä½³å®è·µ

### 1. æ•è·å…·ä½“å¼‚å¸¸

```java
// âœ… å¥½çš„åšæ³•ï¼šæ•è·å…·ä½“å¼‚å¸¸
try {
    int result = 10 / 0;
} catch (ArithmeticException e) {
    System.out.println("ç®—æœ¯å¼‚å¸¸: " + e.getMessage());
}

// âŒ ä¸å¥½çš„åšæ³•ï¼šæ•è·æ‰€æœ‰å¼‚å¸¸
try {
    int result = 10 / 0;
} catch (Exception e) {
    System.out.println("å¼‚å¸¸: " + e.getMessage());
}
```

### 2. ä¸è¦å¿½ç•¥å¼‚å¸¸

```java
// âŒ ä¸å¥½çš„åšæ³•ï¼šå¿½ç•¥å¼‚å¸¸
try {
    processFile();
} catch (IOException e) {
    // ä»€ä¹ˆéƒ½ä¸åš
}

// âœ… å¥½çš„åšæ³•ï¼šè‡³å°‘è®°å½•æ—¥å¿—
try {
    processFile();
} catch (IOException e) {
    System.err.println("å¤„ç†æ–‡ä»¶å¤±è´¥: " + e.getMessage());
    e.printStackTrace();
}
```

### 3. ä½¿ç”¨ finally æ¸…ç†èµ„æº

```java
// âœ… å¥½çš„åšæ³•ï¼šä½¿ç”¨ finally æ¸…ç†èµ„æº
FileInputStream fis = null;
try {
    fis = new FileInputStream("file.txt");
    // ä½¿ç”¨èµ„æº
} catch (IOException e) {
    System.out.println("IO å¼‚å¸¸: " + e.getMessage());
} finally {
    if (fis != null) {
        try {
            fis.close();
        } catch (IOException e) {
            System.out.println("å…³é—­æ–‡ä»¶å¤±è´¥: " + e.getMessage());
        }
    }
}
```

### 4. ä½¿ç”¨ try-with-resources

```java
// âœ… æ›´å¥½çš„åšæ³•ï¼šä½¿ç”¨ try-with-resources
try (FileInputStream fis = new FileInputStream("file.txt")) {
    // ä½¿ç”¨èµ„æº
} catch (IOException e) {
    System.out.println("IO å¼‚å¸¸: " + e.getMessage());
}
// èµ„æºè‡ªåŠ¨å…³é—­
```

## å®Œæ•´ç¤ºä¾‹

```java
public class ExceptionExample {
    // æ–¹æ³•æŠ›å‡ºå¼‚å¸¸
    public static void divide(int a, int b) throws ArithmeticException {
        if (b == 0) {
            throw new ArithmeticException("é™¤æ•°ä¸èƒ½ä¸º0");
        }
        int result = a / b;
        System.out.println("ç»“æœ: " + result);
    }
    
    // è¯»å–æ–‡ä»¶
    public static void readFile(String filename) throws IOException {
        FileInputStream fis = new FileInputStream(filename);
        int data;
        while ((data = fis.read()) != -1) {
            System.out.print((char) data);
        }
        fis.close();
    }
    
    // éªŒè¯å¹´é¾„
    public static void validateAge(int age) {
        if (age < 0 || age > 150) {
            throw new IllegalArgumentException("å¹´é¾„å¿…é¡»åœ¨ 0-150 ä¹‹é—´");
        }
        System.out.println("å¹´é¾„æœ‰æ•ˆ: " + age);
    }
    
    public static void main(String[] args) {
        // å¤„ç†ç®—æœ¯å¼‚å¸¸
        try {
            divide(10, 0);
        } catch (ArithmeticException e) {
            System.out.println("æ•è·å¼‚å¸¸: " + e.getMessage());
        }
        
        // å¤„ç† IO å¼‚å¸¸
        try {
            readFile("file.txt");
        } catch (IOException e) {
            System.out.println("æ–‡ä»¶è¯»å–å¤±è´¥: " + e.getMessage());
        }
        
        // å¤„ç†å‚æ•°å¼‚å¸¸
        try {
            validateAge(-1);
        } catch (IllegalArgumentException e) {
            System.out.println("éªŒè¯å¤±è´¥: " + e.getMessage());
        }
        
        // ä½¿ç”¨ try-with-resources
        try (FileInputStream fis = new FileInputStream("file.txt")) {
            int data = fis.read();
            System.out.println("è¯»å–æ•°æ®: " + data);
        } catch (IOException e) {
            System.out.println("IO å¼‚å¸¸: " + e.getMessage());
        }
    }
}
```

## ä¸‹ä¸€æ­¥

æŒæ¡äº†å¼‚å¸¸å¤„ç†åï¼Œå¯ä»¥ç»§ç»­å­¦ä¹ ï¼š

- [æ–‡ä»¶ä¸IO](/java/15-æ–‡ä»¶ä¸IO.md) - å­¦ä¹ æ–‡ä»¶æ“ä½œ
- [æ³›å‹](/java/16-æ³›å‹.md) - å­¦ä¹ æ³›å‹çš„ä½¿ç”¨

---

<div style="text-align: center; margin-top: 2rem;">
  <p>ğŸ’¡ <strong>æç¤º</strong>ï¼šè‰¯å¥½çš„å¼‚å¸¸å¤„ç†å¯ä»¥æé«˜ç¨‹åºçš„å¥å£®æ€§ï¼Œæ­£ç¡®å¤„ç†å¼‚å¸¸æ˜¯ç¼–å†™é«˜è´¨é‡ä»£ç çš„é‡è¦éƒ¨åˆ†</p>
</div>
